create database car_dashboard;

DELETE FROM seoul_fuel_registration WHERE 시도 = '서울';

INSERT INTO seoul_fuel_registration (연도, 시도, 전기_승용, 하이브리드_승용, 수소_승용) VALUES
('2022', '서울', 48914, 166881, 2896),
('2023', '서울', 60154, 205886, 3113),
('2024', '서울', 70021, 256227, 3158),
('2025', '서울', 86344, 312617, 3059)
AS new_data(연도, 시도, 전기_승용, 하이브리드_승용, 수소_승용)
ON DUPLICATE KEY UPDATE
    전기_승용 = new_data.전기_승용,
    하이브리드_승용 = new_data.하이브리드_승용,
    수소_승용 = new_data.수소_승용;

-- 확인
SELECT * FROM seoul_fuel_registration WHERE 시도 = '서울' ORDER BY 연도;

-- 2. seoul_size_registration 테이블 업데이트 (규모별)
DELETE FROM seoul_size_registration WHERE 시도 = '서울';

INSERT INTO seoul_size_registration (연도, 시도, 규모, 승용) VALUES
('2022', '서울', '소형', 42837),
('2022', '서울', '중형', 1594272),
('2022', '서울', '대형', 942359),
('2022', '서울', '경형(일반)', 181878),
('2022', '서울', '경형(초소형)', 355),

('2023', '서울', '소형', 39053),
('2023', '서울', '중형', 1600193),
('2023', '서울', '대형', 954279),
('2023', '서울', '경형(일반)', 181831),
('2023', '서울', '경형(초소형)', 346),

('2024', '서울', '소형', 36455),
('2024', '서울', '중형', 1600433),
('2024', '서울', '대형', 958652),
('2024', '서울', '경형(일반)', 178534),
('2024', '서울', '경형(초소형)', 373),

('2025', '서울', '소형', 34194),
('2025', '서울', '중형', 1605791),
('2025', '서울', '대형', 956381),
('2025', '서울', '경형(일반)', 173250)seoul_chargersseoul_chargers,
('2025', '서울', '경형(초소형)', 324)
AS new_data(연도, 시도, 규모, 승용)
ON DUPLICATE KEY UPDATE
    승용 = new_data.승용;

-- 확인
SELECT 연도, 규모, 승용 FROM seoul_size_registration WHERE 시도 = '서울' ORDER BY 연도, 규모;

CREATE TABLE seoul_ev_monthly (
    연월 CHAR(6) NOT NULL PRIMARY KEY,
    등록대수 INT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
CREATE TABLE seoul_car_total_monthly (
    연월 CHAR(6) NOT NULL PRIMARY KEY,
    등록대수 INT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

INSERT INTO seoul_car_total_monthly (연월, 등록대수)
VALUES
('202301', 2765782),
('202302', 2764741),
('202303', 2768314),
('202304', 2769310),
('202305', 2769040),
('202306', 2771665),
('202307', 2772712),
('202308', 2772092),
('202309', 2774685),
('202310', 2775115),
('202311', 2775702),
('202312', 2776116),
('202401', 2776742),
('202402', 2776324),
('202403', 2775204),
('202404', 2775073),
('202405', 2774286),
('202406', 2775172),
('202407', 2774788),
('202408', 2774487),
('202409', 2775181),
('202410', 2775382),
('202411', 2775483),
('202412', 2774805),
('202501', 2775365),
('202502', 2773986),
('202503', 2774761),
('202504', 2774168),
('202505', 2773311),
('202506', 2774627),
('202507', 2773024),
('202508', 2772133),
('202509', 2771577),
('202510', 2769593),
('202511', 2769940)
AS new
ON DUPLICATE KEY UPDATE
등록대수 = new.등록대수;

INSERT INTO seoul_ev_monthly (연월, 등록대수)
VALUES
('202301', 51045),
('202302', 50957),
('202303', 52101),
('202304', 52876),
('202305', 53800),
('202306', 55223),
('202307', 56625),
('202308', 58035),
('202309', 59718),
('202310', 61244),
('202311', 62891),
('202312', 64753),
('202401', 66342),
('202402', 67921),
('202403', 69488),
('202404', 70935),
('202405', 72314),
('202406', 73902),
('202407', 75261),
('202408', 76840),
('202409', 78215),
('202410', 80132),
('202411', 81275),
('202412', 82691),
('202501', 83510),
('202502', 84231),
('202503', 85124),
('202504', 86011),
('202505', 86894),
('202506', 87533),
('202507', 78270),
('202508', 80270),
('202509', 82501),
('202510', 83881),
('202511', 86344)
AS new
ON DUPLICATE KEY UPDATE
등록대수 = new.등록대수;

CREATE TABLE IF NOT EXISTS seoul_ev_ratio_monthly (
    ym INT PRIMARY KEY,
    total_cars INT NOT NULL,
    ev_cars INT NOT NULL,
    ev_ratio FLOAT NOT NULL
);

INSERT IGNORE INTO seoul_ev_ratio_monthly (ym, total_cars, ev_cars, ev_ratio) VALUES
(202511, 2769940, 86344, 0.031171794),
(202510, 2769593, 83881, 0.030286399),
(202509, 2771577, 82501, 0.029766808),
(202508, 2772133, 80270, 0.028956042),
(202507, 2773024, 78270, 0.028225504),
(202506, 2774627, 77028, 0.027761569),
(202505, 2773311, 75181, 0.027108752),
(202504, 2774168, 73278, 0.026414406),
(202503, 2774761, 72401, 0.026092698),
(202502, 2773986, 71258, 0.025687945),
(202501, 2775365, 70736, 0.025487098),
(202412, 2774805, 71005, 0.025589186),
(202411, 2774447, 70021, 0.025237822),
(202410, 2773641, 68906, 0.024843157),
(202409, 2776237, 68438, 0.024651354),
(202408, 2775503, 67939, 0.024478086),
(202407, 2776926, 67154, 0.024182855),
(202406, 2777421, 65999, 0.023762692),
(202405, 2775671, 64450, 0.023219611),
(202404, 2775054, 63319, 0.022817214),
(202403, 2775386, 62607, 0.022557943),
(202402, 2776324, 61273, 0.02206983),
(202401, 2776742, 61208, 0.022043099),
(202312, 2776116, 61304, 0.022082651),
(202311, 2775702, 60154, 0.021671635),
(202310, 2775115, 58938, 0.021238039),
(202309, 2774685, 57811, 0.020835158),
(202308, 2772092, 56490, 0.020378112),
(202307, 2772712, 55879, 0.020153193),
(202306, 2771665, 55268, 0.019940361),
(202305, 2769040, 53800, 0.019429116),
(202304, 2769310, 52876, 0.019093565),
(202303, 2768314, 52101, 0.018820481),
(202302, 2764741, 50957, 0.018431021),
(202301, 2765782, 51045, 0.018455901);

CREATE TABLE IF NOT EXISTS seoul_cctv_accident (
    year INT NOT NULL,
    gu VARCHAR(50) NOT NULL,
    cctv INT NOT NULL,
    accidents INT NOT NULL,
    PRIMARY KEY (year, gu)  -- 연도 + 자치구 조합으로 중복 방지
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- 2. 데이터 삽입 (INSERT IGNORE로 중복 시 무시)
INSERT IGNORE INTO seoul_cctv_accident (year, gu, cctv, accidents) VALUES
(2025, '강남구', 890, 3754),
(2025, '강동구', 140, 1428),
(2025, '강북구', 111, 877),
(2025, '강서구', 164, 1538),
(2025, '관악구', 751, 1254),
(2025, '광진구', 78, 785),
(2025, '구로구', 315, 1320),
(2025, '금천구', 195, 798),
(2025, '노원구', 158, 1288),
(2025, '도봉구', 114, 522),
(2025, '동대문구', 287, 1520),
(2025, '동작구', 66, 1230),
(2025, '마포구', 235, 1201),
(2025, '서대문구', 421, 818),
(2025, '서초구', 1295, 2027),
(2025, '송파구', 439, 2500),
(2025, '영등포구', 613, 1948),
(2025, '용산구', 357, 868),
(2025, '은평구', 384, 1218),
(2025, '종로구', 287, 917),
(2025, '중구', 345, 976),
(2025, '중랑구', 304, 1199);

CREATE TABLE vehicle_classification (
    no INT PRIMARY KEY,                  -- 번호 (기본키)
    displacement DECIMAL(10,2),           -- 배기량 (cc), 소수점 포함 가능 (예: 1960.5)
    fuel_efficiency DECIMAL(5,2),        -- 연비 (km/L), 소수점 2자리
    vehicle_type VARCHAR(20)             -- 차종: 일반, 하이브리드, 전기차
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

INSERT INTO vehicle_classification (no, displacement, fuel_efficiency, vehicle_type) VALUES
(1, 1580.00, 20.00, '하이브리드'),
(2, 1999.00, 11.60, '일반'),
(3, 1999.00, 12.00, '일반'),
(4, 2999.00, 12.00, '일반'),
(5, 998.00, 15.70, '일반'),
(6, 1998.00, 10.00, '일반'),
(7, 2790.00, 10.00, '일반'),
(8, 1995.00, 14.00, '일반'),
(9, 2476.00, 9.00, '일반'),
(10, 798.00, 13.00, '일반'),
(11, 2902.00, 12.00, '일반'),
(12, 2497.00, 10.00, '일반'),
(13, 1368.00, 14.00, '일반'),
(14, 998.00, 15.00, '일반'),
(15, 1461.00, 19.00, '일반'),
(16, 1995.00, 13.00, '일반'),
(17, 1995.00, 14.00, '일반'),
(18, 1995.00, 13.00, '일반'),
(19, 2359.00, 16.00, '하이브리드'),
(20, 1999.00, 12.00, '일반'),
(21, 2497.00, 9.00, '일반'),
(22, 1995.00, 14.00, '일반'),
(23, 1500.00, 10.00, '일반'),
(24, 1995.00, 14.00, '일반'),
(25, 1995.00, 14.00, '일반'),
(26, 1995.00, 14.00, '일반'),
(27, 2199.00, 11.00, '일반'),
(28, 1591.00, 14.00, '일반'),
(29, 2199.00, 11.00, '일반'),
(30, 2497.00, 10.00, '일반'),
(31, 1500.00, 12.00, '일반'),
(32, 1500.00, 12.00, '일반'),
(33, 2199.00, 13.00, '일반'),
(34, 2199.00, 13.00, '일반'),
(35, 2359.00, 16.00, '하이브리드'),
(36, 1999.00, 12.00, '일반'),
(37, 180.00, 5.30, '전기차'),
(38, 2497.00, 10.00, '일반'),
(39, 180.00, 5.30, '전기차'),
(40, 1580.00, 17.10, '하이브리드'),
(41, 1580.00, 17.10, '하이브리드'),
(42, 1960.50, 12.50, '일반'),
(43, 1787.40, 17.70, '하이브리드'),
(44, 180.00, 5.30, '전기차'),
(45, 180.00, 5.30, '전기차'),
(46, 180.00, 5.30, '전기차'),
(47, 180.00, 5.30, '전기차'),
(48, 180.00, 5.30, '전기차'),
(49, 180.00, 5.30, '전기차'),
(50, 180.00, 5.30, '전기차'),
(51, 180.00, 5.30, '전기차'),
(52, 180.00, 5.30, '전기차'),
(53, 180.00, 5.30, '전기차'),
(54, 180.00, 5.30, '전기차'),
(55, 1960.50, 12.50, '일반'),
(56, 180.00, 5.30, '전기차'),
(57, 1787.40, 17.70, '하이브리드'),
(58, 1465.00, 17.70, '하이브리드'),
(59, 1999.00, 19.10, '하이브리드'),
(60, 180.00, 5.30, '전기차'),
(61, 180.00, 5.30, '전기차'),
(62, 998.00, 15.70, '일반'),
(63, 180.00, 5.30, '전기차'),
(64, 180.00, 5.30, '전기차'),
(65, 1580.00, 17.10, '하이브리드'),
(66, 1999.00, 20.10, '하이브리드'),
(67, 180.00, 5.30, '전기차'),
(68, 180.00, 5.30, '전기차'),
(69, 180.00, 5.30, '전기차'),
(70, 1580.00, 17.10, '하이브리드'),
(71, 1580.00, 17.10, '하이브리드'),
(72, 1960.50, 12.50, '일반'),
(73, 1960.50, 12.50, '일반'),
(74, 1787.40, 17.70, '하이브리드'),
(75, 1960.50, 12.50, '일반'),
(76, 180.00, 5.30, '전기차'),
(77, 180.00, 5.30, '전기차');

-- 새 테이블 생성: 동력유형별 대표 차종
CREATE TABLE car_model_by_power_type (
    id INT AUTO_INCREMENT PRIMARY KEY,
    power_type VARCHAR(20) NOT NULL,        -- 동력유형: 일반, 하이브리드, 전기차
    model_name VARCHAR(100) NOT NULL        -- 대표 차종 이름
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- 데이터 삽입
INSERT INTO car_model_by_power_type (power_type, model_name) VALUES
('하이브리드', '아이오닉 하이브리드'),
('일반', 'K5'),
('일반', '싼타페'),
('일반', '그랜저HG'),
('일반', '모닝'),
('일반', 'SM5'),
('일반', '봉고'),
('일반', '싼타페'),
('일반', '스타렉스'),
('일반', '비스토'),
('일반', '카니발'),
('일반', '그랜드 스타렉스'),
('일반', '엑센트'),
('일반', '모닝'),
('일반', 'QM3'),
('일반', '투싼'),
('일반', '싼타페'),
('일반', 'QM5'),
('하이브리드', '그랜져IG 하이브리드'),
('일반', '싼타페'),
('일반', '포터'),
('일반', '투싼'),
('일반', '모하비'),
('일반', '싼타페'),
('일반', '쏘렌토'),
('일반', '투싼'),
('일반', '카니발'),
('일반', 'K3'),
('일반', '카니발'),
('일반', '그랜드 스타렉스'),
('일반', '아반떼'),
('일반', '아반떼'),
('일반', '쏘렌토'),
('일반', '쏘렌토'),
('하이브리드', '그랜저 하이브리드'),
('일반', '싼타페'),
('전기차', 'EV6'),
('일반', '그랜드 스타렉스'),
('전기차', 'EV6'),
('하이브리드', '니로 하이브리드'),
('하이브리드', '니로 하이브리드'),
('일반', '카니발'),
('하이브리드', '쏘렌토 하이브리드'),
('전기차', '니로EV'),
('전기차', '아이오닉5'),
('전기차', 'EV6'),
('전기차', 'EV6'),
('전기차', 'EV6'),
('전기차', 'EV6'),
('전기차', 'EV6'),
('전기차', 'EV6'),
('전기차', 'EV6'),
('전기차', 'EV6'),
('일반', '스타리아'),
('전기차', '레이EV'),
('하이브리드', '쏘렌토 하이브리드'),
('하이브리드', 'K5 하이브리드'),
('하이브리드', '쏘나타 하이브리드'),
('전기차', '아이오닉5'),
('전기차', 'EV6'),
('일반', '모닝'),
('전기차', '아이오닉5'),
('전기차', 'EV6'),
('하이브리드', '니로 하이브리드'),
('하이브리드', 'K5 하이브리드'),
('전기차', 'EV6'),
('전기차', 'EV6'),
('전기차', 'EV6'),
('하이브리드', '니로 하이브리드'),
('하이브리드', '니로 하이브리드'),
('일반', '카니발'),
('일반', '카니발'),
('하이브리드', '쏘렌토 하이브리드'),
('일반', '올뉴카니발'),
('전기차', 'EV6'),
('전기차', 'EV6');